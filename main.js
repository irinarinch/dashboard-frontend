(()=>{"use strict";var t={p:""};const e=t.p+"f1729103c6e9ba0685d4.png",s=t.p+"1e96afbf60e96852dff0.png",n=t.p+"97a7943d43c679d32a60.png",a=t.p+"86cb4c637ab7d1cf0afa.png",c=t.p+"7d45695fec4419fa3352.png";class i{static async get(){return(await fetch("https://dashboard-backend-8cy1.onrender.com/",{method:"GET"})).json()}static async post(){await fetch("https://dashboard-backend-8cy1.onrender.com/",{method:"POST"})}static async delete(t){await fetch(`https://dashboard-backend-8cy1.onrender.com/?id=${t}`,{method:"DELETE"})}}class r{constructor(){this.widgetContainer=document.querySelector(".instances"),this.websocket=new WebSocket("wss://dashboard-backend-8cy1.onrender.com/")}init(){this.render(),document.addEventListener("click",(t=>{this.createInstance(t),this.deleteInstance(t),this.startInstance(t)}))}createInstance(t){t.target.closest("button")&&(i.post(),setTimeout((()=>{this.render()}),11e3))}deleteInstance(t){if(!t.target.closest(".remover"))return;const{id:e}=t.target.closest(".instance").dataset;i.delete(e).then((()=>{this.render()}))}startInstance(t){if(t.target.closest(".stopped-action")||t.target.closest(".running-action")){const{id:e}=t.target.closest(".instance").dataset;this.websocket.send(JSON.stringify({id:e})),this.render()}}render(){this.widgetContainer.innerHTML="",i.get().then((t=>{t.data.forEach((t=>{const e=r.createElement(t);this.widgetContainer.appendChild(e).dataset.id=t.id}))}))}static createElement(t){const e=document.createElement("div");return e.className="instance",e.innerHTML=`\n      <div class="instance-id">${t.id}</div>\n      <div class="instance-status">\n        <span class="status">Status:</span>\n        <img class="status-img ${t.state}" src=${r.getStatusImage(t)}>\n        <span class="status-msg">${t.state}</span>\n      </div>\n      <div class="instance-actions">\n        <span class="actions">Actions:</span>\n        <img class="action-img ${t.state}-action" src=${r.getActionImage(t)}>\n        <img class="action-img remover" src=${c}>   \n      </div>\n    `,e}static getStatusImage(t){return"stopped"===t.state?e:s}static getActionImage(t){return"stopped"===t.state?a:n}}class d{constructor(){this.eventSource=new EventSource("https://dashboard-backend-8cy1.onrender.com/sse"),this.worklog=document.querySelector(".worklog-container")}init(){this.eventSource.addEventListener("message",(t=>{const e=d.createLogItem(JSON.parse(t.data));this.worklog.appendChild(e)}))}static createLogItem(t){const e=document.createElement("div");return e.className="log-item",e.innerHTML=`\n      <div class="timestamp">${t.timeStamp}</div>\n      <div class="server">Server: ${t.id}</div>\n      <div class="info">INFO: ${t.info}</div>      \n    `,e}}const o=new r,m=new d;o.init(),m.init()})();